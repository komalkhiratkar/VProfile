
 
 pipeline {
    agent any


      tools {
        jdk "java-8"
        maven "maven-3"
    }
    stages {
        stage ('clone'){
            steps {
                  " git branch: 'ansible-pipeline', url: 'https://github.com/komalkhiratkar/VProfile.git' "
            }
        }
        stage ('test'){
            steps {
                echo " running test cases"
            }
        }
        stage ('build') {
            steps {
                sh 'mvn package'
            }
        }
         stage ("ansible-playbook-run"){
            steps {
               ansiblePlaybook credentialsId: 'ansible-ubuntu', disableHostKeyChecking: true, playbook: 'tomcat-playbook.yml', sudoUser: 'ansadm', vaultTmpPath: ''
   }
  }

       stage('deploy to tomcat'){
         steps{

          deploy adapters: [tomcat8(credentialsId: 'tomcatcreds', path: '', url: '  http://172.31.5.53:8080')], contextPath: 'feb -5', war: 'target/vprofile-v1.war'

     }
    }

 }
}

